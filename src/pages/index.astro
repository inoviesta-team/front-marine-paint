---
import MarineLayout from "@layouts/MarineLayout.astro";
import MarineHeader from "@components/layout/MarineHeader";
import MarineFooter from "@components/layout/MarineFooter";
import MarineButton from "@components/ui/MarineButton";
import MarineProductCard from "@components/product/MarineProductCard";
import MarineProjectCard from "@components/project/MarineProjectCard";
import MarineArticleCard from "@components/article/MarineArticleCard";
import MarineValueCard from "@components/value/MarineValueCard";
import MarineTestimonialCard from "@components/testimonial/MarineTestimonialCard";
import MarineContactForm from "@components/contact/MarineContactForm";
import FloatingWhatsAppButton from "@components/ui/FloatingWhatsAppButton";
import { marineApi } from "@api/marineApi";

// Fetch data for the page
let products = [];
let projects = [];
let articles = [];
let testimonials = [];
let partners = [];

try {
  // Fetch products
  products = await marineApi.getProducts({ limit: 5 });
  
  // Fetch projects
  projects = await marineApi.getProjects({ limit: 4 });
  
  // Fetch articles
  articles = await marineApi.getArticles({ limit: 3 });
  
  // Fetch testimonials
  testimonials = await marineApi.getTestimonials();
  
  // Fetch partners
  partners = await marineApi.getPartners();
} catch (error) {
  console.error('Failed to fetch data:', error);
}
---

<MarineLayout
  title="Toko Koko Lie - Marine Paint Solutions"
  description="Toko Koko Lie menyediakan cat marine terpercaya untuk ketahanan maksimal. Official partner of Ashdaq Paint."
>
  <MarineHeader client:load />
  
  <!-- Hero Section -->
  <section class="py-20 relative overflow-hidden">
    <div class="absolute inset-0 bg-[url('/images/ocean-pattern.svg')] opacity-10 z-0"></div>
    <div class="absolute inset-0 bg-gradient-to-r from-marine-darkBlue/80 to-marine-blue/70 z-0"></div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
        <div class="space-y-8">
          <h3 class="font-mono font-bold text-white text-xl border-l-4 border-marine-lightBlue pl-3">TOKO KOKO LIE</h3>
          <div class="space-y-4">
            <h1 class="font-mono font-bold text-white text-3xl md:text-4xl lg:text-5xl drop-shadow-md">
              Solusi Terbaik untuk Kebutuhan Cat Kapal Anda
            </h1>
            <p class="font-mono text-gray-100 text-lg">
              Kami menyediakan berbagai jenis cat marine berkualitas tinggi untuk semua jenis kapal dan aplikasi maritim.
            </p>
          </div>
          
          <div class="flex flex-wrap gap-4">
            <MarineButton
              as="a" 
              href="/products" 
              variant="primary"
            >
              Belanja Sekarang
            </MarineButton>
            
            <MarineButton
              as="a" 
              href="/contact-us" 
              variant="secondary"
              className="flex items-center gap-2"
            >
              <span>Hubungi kami</span>
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M20 4H4C2.9 4 2.01 4.9 2.01 6L2 18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM20 8L12 13L4 8V6L12 11L20 6V8Z" fill="currentColor"/>
              </svg>
            </MarineButton>
          </div>
        </div>
        
        <div class="h-48 md:h-64 lg:h-80 flex items-center justify-center">
          <img src="/images/dummy_hero.svg" alt="Hero Image" class="w-full h-full object-cover" />
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Products Section -->
  <section class="py-16 bg-white">
    <div class="relative overflow-hidden">
      <div class="absolute -top-40 -right-40 w-80 h-80 rounded-full bg-marine-lightBlue opacity-10"></div>
      <div class="absolute -bottom-40 -left-40 w-80 h-80 rounded-full bg-marine-blue opacity-10"></div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="font-mono font-bold text-marine-blue text-3xl text-center mb-12">Featured Products</h2>
      
      <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
        {products.map((product) => (
          <MarineProductCard product={product} />
        ))}
      </div>
      
      <div class="flex justify-center mt-8">
        <MarineButton as="a" href="/products" variant="secondary">
          Lihat Semua
        </MarineButton>
      </div>
    </div>
  </section>

  <!-- Value Proposition Section -->
  <section class="py-16 relative overflow-hidden">
    <div class="absolute inset-0 bg-[url('/images/wave-pattern.svg')] opacity-5 z-0"></div>
    <div class="absolute inset-0 bg-gradient-to-br from-marine-blue/10 to-marine-lightBlue/5 z-0"></div>
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="font-mono font-bold text-marine-blue text-3xl text-center mb-12">Value Proposition</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <MarineValueCard title="Produk Berkualitas" iconNumber={1} />
        <MarineValueCard title="Pengiriman Cepat" iconNumber={2} />
        <MarineValueCard title="Konsultasi Gratis" iconNumber={3} />
        <MarineValueCard title="Dukungan Teknis" iconNumber={4} />
      </div>
    </div>
  </section>

  <!-- Projects Section -->
  <section class="py-16 bg-white relative overflow-hidden">
    <div class="absolute -top-20 -left-20 w-40 h-40 rounded-full bg-marine-accent opacity-5"></div>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
      <h2 class="font-mono font-bold text-marine-blue text-3xl text-center mb-12">Projects</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        {projects.map((project) => (
          <MarineProjectCard project={project} />
        ))}
      </div>
      
      <div class="flex justify-center mt-8">
        <MarineButton as="a" href="/projects" variant="secondary">
          Lihat Semua
        </MarineButton>
      </div>
    </div>
  </section>

  <!-- Testimonials Section -->
  <section class="py-16 relative overflow-hidden">
    <div class="absolute inset-0 bg-marine-bg-gradient opacity-10 z-0"></div>
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="font-mono font-bold text-marine-blue text-3xl text-center mb-12">Testimonials</h2>
      
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {testimonials.map((testimonial) => (
          <MarineTestimonialCard testimonial={testimonial} />
        ))}
      </div>
    </div>
  </section>

  <!-- Company Partners Section -->
  <section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="font-mono font-bold text-marine-blue text-3xl text-center mb-12">Company Partners</h2>
      
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-8">
        {partners.map((partner, index) => (
          <div class="h-20 flex items-center justify-center">
            <img 
              src={`/images/partners/partner_${index + 1}.svg`} 
              alt={partner.name}
              class="max-h-full max-w-full"
            />
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Related Articles Section -->
  <section class="py-16 relative overflow-hidden">
    <div class="absolute inset-0 bg-gray-100 z-0"></div>
    <div class="absolute inset-0 bg-[url('/images/ship-pattern.svg')] opacity-5 z-0"></div>
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="font-mono font-bold text-marine-blue text-3xl text-center mb-12">Related Articles</h2>
      
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        {articles.map((article) => (
          <MarineArticleCard article={article} />
        ))}
      </div>
      
      <div class="flex justify-center mt-8">
        <MarineButton as="a" href="/articles" variant="secondary">
          Lihat Semua
        </MarineButton>
      </div>
    </div>
  </section>

  <!-- Contact Section -->
  <section class="py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h2 class="font-mono font-bold text-marine-blue text-3xl text-center mb-12">Hubungi kami</h2>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <div>
          <!-- Contact text -->
          <h3 class="font-mono font-bold text-marine-darkBlue text-xl mb-4">Butuh Bantuan?</h3>
          <p class="font-mono text-gray-700 mb-8">
            Kami siap membantu anda dengan segala pertanyaan tentang produk kami. Silakan isi formulir di bawah ini dan tim kami akan segera menghubungi Anda.
          </p>
          
          <MarineContactForm client:load />
        </div>
        
        <div class="rounded-full h-full flex items-center justify-center overflow-hidden">
          <img src="/images/map.svg" alt="Map" class="w-full h-full object-cover" />
        </div>
      </div>
    </div>
  </section>

  <!-- Floating WhatsApp Button -->
  <FloatingWhatsAppButton client:load />

  <!-- Footer -->
  <MarineFooter client:visible />
</MarineLayout>
