---
import MainLayout from '../../layouts/MainLayout.astro';
import ProductGallery from './components/ProductGallery';
import ProductInfo from './components/ProductInfo';
import Application from './components/productTabs/Application.astro';
import Details from './components/productTabs/Details.astro';
import Reviews from './components/productTabs/Reviews.astro';
import Specification from './components/productTabs/Specification.astro';
import TabSection from './components/TabSection';

export async function getStaticPaths() {

  const product = {
        id: "anti-fouling-300",
        name: "Anti-fouling 300",
        rating: 4.9,
        ratingCount: 90,
        price: 126000,
        originalPrice: 210000,
        discount: 40,
        description: "Lorem ipsum dolor sit amet consectetur...",
        images: [
          "https://down-id.img.susercontent.com/file/id-11134207-7r98z-lt24547ku47tac@resize_w450_nl.webp",
          "https://down-id.img.susercontent.com/file/id-11134207-7r98z-lt24547ku47tac@resize_w450_nl.webp",
          "https://down-id.img.susercontent.com/file/id-11134207-7r98z-lt24547ku47tac@resize_w450_nl.webp"
        ],
        details: {
          uses: "Lorem ipsum dolor sit amet consectetur...",
          preparation: "Lorem ipsum dolor sit amet consectetur..."
        },
        specification: "Specification content here...",
        application: "Application content here...",
        reviews: []
      }

  return [
    {
      params: { slug: product.id },
      props: { product }
    }
  ];
}

const { product } = Astro.props;

console.log("product: ", product);

const { slug } = Astro.params;

const breadcrumbs = [
  { name: "Home", url: "/" },
  { name: "Products", url: "/products" },
  { name: product.name, url: `/product/${slug}`, current: true }
];
---

<MainLayout title={product.name}>
  <!-- Breadcrumbs -->
  <div class="container mx-auto py-2 px-4 md:px-14 mt-6">
    <nav class="flex text-sm text-gray-500">
      {breadcrumbs.map((crumb, index) => (
        <>
          {index > 0 && <span class="mx-2">/</span>}
          {crumb.current ? (
            <span class="font-semibold text-gray-800">{crumb.name}</span>
          ) : (
            <a href={crumb.url} class="hover:text-blue-800">{crumb.name}</a>
          )}
        </>
      ))}
    </nav>
  </div>
  
  <!-- Product Section -->
  <section class="container mx-auto py-8 px-4 md:px-14">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Product Gallery -->
      <div>
        <ProductGallery images={product.images} client:load />
      </div>
      
      <!-- Product Info -->
      <div>
        <ProductInfo product={product} client:load />
      </div>
    </div>
  </section>
  
  <!-- Tab Section -->
  <section class="container mx-auto py-8 px-4 md:px-14">
    <TabSection client:load>
      <Fragment slot="details">
        <Details details={product.details} />
      </Fragment>
      <Fragment slot="specification">
        <Specification data={product.specification} />
      </Fragment>
      <Fragment slot="application">
        <Application data={product.application} />
      </Fragment>
      <Fragment slot="reviews">
        <Reviews reviews={product.reviews} />
      </Fragment>
    </TabSection>
  </section>
</MainLayout>